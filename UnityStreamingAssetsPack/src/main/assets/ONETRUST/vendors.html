<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <script type="text/javascript" src="ot-utility.js"></script>
    <script type="text/javascript" src="VendorListData.json"></script>
    <link rel="stylesheet" type="text/css" href="onetrust.css" />
    <script type='text/javascript' src='knockout-3.5.1.js'></script>
    <title></title>

    <style>
    </style>

    <script type="text/javascript">
        
        var viewModel;

        function onLoad() {
            try {
                if (window.navigator.userAgent.toLowerCase().indexOf("iphone") != -1)
                {
                    if (window && window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.unityControl)
                    {
                        window.Unity =
                            {
                                call: function(msg)
                                {
                                    window.webkit.messageHandlers.unityControl.postMessage(msg);
                                }
                            }
                    }
                    else
                    {
                        window.Unity =
                            {
                                call: function(msg)
                                {
                                    window.location = 'unity:' + msg;
                                }
                            }
                    }
                }

                ko.options.deferUpdates = true;
                viewModel = new VendorListModel();
                ko.applyBindings(viewModel);

                document.getElementById("iab").checked = true;
                viewModel.iabSelected(true);

                document.getElementById("googleVendorList").style.display = viewModel.iabSelected() ? "none" : "block";
                document.getElementById("vendorList").style.display = viewModel.iabSelected() ? "block" : "none";

                document.getElementById("allGoogle").style.display = viewModel.iabSelected() ? "none" : "block";
                document.getElementById("allIAB").style.display = viewModel.iabSelected() ? "block" : "none";


                setTimeout(
                    function () {
                        document.getElementById("spinner").style.display = "none";
                        document.getElementById("VendorListPageFragment").style.display = "block";
                    }, 800);

            }
            catch (err) {
                document.getElementById("errorMsg").innerHTML = err.message;
            }
            finally {
                Unity.call('HTTPS://OTSDK/vendorlist|didLoadData');
            }

        }

        function VendorListModel() {

            // Data for Vendor List Page
            this.data = jsonDataFromFile;

            for (var key in this.data) {
                if (key.toLowerCase().includes("color")) {
                    this.data[key] = ko.observable(this.data[key]);
                }
            }

            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            this.requestedOptanonGroupId = urlParams.get('OptanonGroupId');


            this.data.showNavBar = true;
            this.data.showBackButton = true;
            this.showClearButton = ko.observable(false);
            this.iabSelected = ko.observable(true);
            this.showSelectAll_IAB = ko.observable(true)
            this.showSelectAll_GOOGLE = ko.observable(true)
            this.searchHasFocus = ko.observable(false);
            this.showingFilter = ko.observable(false);
            this.vendors = ko.observableArray(this.data.vendors);
            this.orginalSelectedFilters = [];
            this.FilterGroupNames = ko.observableArray([]);
            this.searchValue = ko.observable("");
            this.SelectedVendorID = ko.observable("-1");



            // Data for Vendor Detail Page
            this.consentPurposes = ko.observableArray([]);
            this.specialPurposes = ko.observableArray([]);
            this.consentFeatures = ko.observableArray([]);
            this.specialFeatures = ko.observableArray([]);



            // Page Colors
            document.documentElement.style.setProperty('--toggleBorderColor', this.data.listItemTitleTextColorCalculated());
            document.documentElement.style.setProperty('--toggleActiveColor', this.data.toggleActiveColorCalculated());
            document.documentElement.style.setProperty('--toggleInactiveColor', this.data.toggleInactiveColorCalculated());
            document.documentElement.style.setProperty('--toggleActiveColorThumb', pSBC(-0.66, this.data.toggleActiveColorCalculated()));
            document.documentElement.style.setProperty('--toggleInactiveColorThumb', pSBC(-0.50, this.data.toggleInactiveColorCalculated()));
            document.documentElement.style.setProperty('--placeholderTextColor', pSBC(-0.50, this.data.listItemTitleTextColorCalculated()));
            document.documentElement.style.setProperty('--filterColor', this.data.savePreferencesButtonColorCalculated());
            document.documentElement.style.setProperty('--spyGlassColor', this.data.listItemTitleTextColorCalculated());
            document.documentElement.style.setProperty('--selectedScopeButtonBackgroundColor', this.data.savePreferencesButtonColorCalculated());


            // initial filter icon settings
            document.getElementById("noFilter").style = "Display:none";
            document.getElementById("filterApplied").style = "Display:block";


            // set the filter field on the vendor list items
            var arrayLength = this.vendors().length;
            for (let i = 0; i < arrayLength; i++) {
                var vendorListItem = this.vendors()[i];
                vendorListItem.vendorConsentToggleIsOn = ko.observable(Boolean(vendorListItem.vendorConsentToggleIsOn));
                vendorListItem.vendorLegitimateInterestToggleIsOn = ko.observable(Boolean(vendorListItem.vendorLegitimateInterestToggleIsOn));
                vendorListItem.searchName = vendorListItem.name.toUpperCase();
                vendorListItem.didMatchSearch = ko.observable(true);
                vendorListItem.matchesFilter = ko.observable(true);
                vendorListItem.isSelected = ko.observable(false);
                vendorListItem.showAnyway = ko.observable(false);
            }

            this.filteredVendorList = ko.computed(function () { return ko.utils.arrayFilter(this.vendors(), function (item) { return (item.didMatchSearch() == true && item.matchesFilter() == true && item.isGoogleVendor == false && item.shouldShowVendor == true) || (item.showAnyway() == true && item.isGoogleVendor == false && item.shouldShowVendor == true); }); }, this);
            this.notSelectedvendors = ko.computed(function () { return ko.utils.arrayFilter(this.vendors(), function (item) { return (item.didMatchSearch() == true && item.matchesFilter() == true && item.isGoogleVendor == false && item.shouldShowVendor == true && item.shouldShowConsentToggleForVendor == true && item.vendorConsentToggleIsOn() == false); }); }, this);
            this.isAllSelected = ko.computed(function () { return this.notSelectedvendors().length == 0 }, this);

            this.filteredVendorList_google = ko.computed(function () { return ko.utils.arrayFilter(this.vendors(), function (item) { return (item.didMatchSearch() == true && item.isGoogleVendor == true && item.shouldShowVendor == true); }); }, this);
            this.notSelectedvendors_google = ko.computed(function () { return ko.utils.arrayFilter(this.vendors(), function (item) { return (item.didMatchSearch() == true && item.isGoogleVendor == true && item.shouldShowVendor == true && item.shouldShowConsentToggleForVendor == true && item.vendorConsentToggleIsOn() == false); }); }, this);
            this.isAllSelected_google = ko.computed(function () { return this.notSelectedvendors_google().length == 0 }, this);
            this.googleVendorsCount = ko.pureComputed(function () { return this.filteredVendorList_google().length; }, this);

            this.selectedVendors = ko.computed(function () { return ko.utils.arrayFilter(this.vendors(), function (item) { return (item.isSelected() == true); }); }, this);


            // Prep Data
            for (const jsonDataKey in this.data.vendorListFilterOptions) {

                var filterItem = this.data.vendorListFilterOptions[jsonDataKey];

                var isSelected = false;
                if (this.requestedOptanonGroupId == null) {
                    isSelected = true;
                } else if (filterItem.Parent === this.requestedOptanonGroupId) {
                    isSelected = true;
                } else if (filterItem.OptanonGroupId === this.requestedOptanonGroupId) {
                    isSelected = true;
                }

                filterItem.isSelected = ko.observable(isSelected);
                this.FilterGroupNames.push(filterItem);
                if (filterItem.isSelected()) {
                    this.orginalSelectedFilters.push(filterItem.GroupNameMobile);
                }

                // respond to switch changes
                filterItem.isSelected.subscribe(function (val) {

                    var selected_purposes = [];
                    var selected_specialPurposes = [];
                    var selected_features = [];
                    var selected_specialFeatures = [];


                    var filtersSelectedCount = 0;
                    var arrayLength = this.FilterGroupNames().length;
                    for (let i = 0; i < arrayLength; i++) {
                        var filterItem = this.FilterGroupNames()[i];
                        if (filterItem.isSelected()) {

                            if (filterItem.type == "features") {
                                selected_features.push(parseInt(filterItem.keyID));
                            }
                            if (filterItem.type == "specialFeatures") {
                                selected_specialFeatures.push(parseInt(filterItem.keyID));
                            }
                            if (filterItem.type == "purposes") {
                                selected_purposes.push(parseInt(filterItem.keyID));
                            }
                            if (filterItem.type == "specialPurposes") {
                                selected_specialPurposes.push(parseInt(filterItem.keyID));
                            }

                            filtersSelectedCount += 1;
                        }
                    }


                    // find the matching vendors //
                    arrayLength = this.vendors().length;
                    for (let i = 0; i < arrayLength; i++) {
                        var vendorListItem = this.vendors()[i];

                        if (vendorListItem.isGoogleVendor == false) {

                            try {

                                if (selected_purposes.length > 0 && vendorListItem.purposes.some(r => selected_purposes.includes(r))) {
                                    vendorListItem.matchesFilter(true);

                                } else if (selected_specialPurposes.length > 0 && vendorListItem.specialPurposes.some(r => selected_specialPurposes.includes(r))) {
                                    vendorListItem.matchesFilter(true);

                                } else if (selected_features.length > 0 && vendorListItem.features.some(r => selected_features.includes(r))) {
                                    vendorListItem.matchesFilter(true);

                                } else if (selected_specialFeatures.length > 0 && specialFeatures.purposes.some(r => selected_specialFeatures.includes(r))) {
                                    vendorListItem.matchesFilter(true);

                                } else {
                                    vendorListItem.matchesFilter(false);
                                }

                                vendorListItem.showAnyway(filtersSelectedCount == 0);

                            } catch (err) {
                                document.getElementById("errorMsg").innerHTML = er.message;

                            }

                        }

                    }

                    // show the correct filter icon
                    if (selected_purposes.length + selected_specialPurposes.length + selected_features.length + selected_specialFeatures.length == 0) {
                        document.getElementById("noFilter").style = "Display:block";
                        document.getElementById("filterApplied").style = "Display:none";
                        document.documentElement.style.setProperty('--filterColor', this.data.listItemTitleTextColorCalculated());
                    } else {
                        document.getElementById("noFilter").style = "Display:none";
                        document.getElementById("filterApplied").style = "Display:block";
                        document.documentElement.style.setProperty('--filterColor', this.data.savePreferencesButtonColorCalculated());
                    }

                }, this);
            }


            // Subscribe to changes
            this.showingFilter.subscribe(function (val) {
                if (val == true) {
                    document.getElementById("footer").classList.add('dim');
                } else {
                    document.getElementById("footer").classList.remove('dim');
                }

                if (val == true) {
                    this.showSelectAll_IAB(false);

                } else {
                    this.showSelectAll_IAB(this.filteredVendorList().length > 0);
                }

            }, this);
            this.searchHasFocus.subscribe(function (val) {
                if (val == true) {
                    this.showingFilter(false);
                    this.showSelectAll_IAB(false);
                    this.showSelectAll_GOOGLE(false);

                } else {

                    if (this.showClearButton() == true) {
                        this.showSelectAll_IAB(false);
                        this.showSelectAll_GOOGLE(false);
                    } else {
                        this.showSelectAll_IAB(this.filteredVendorList().length > 0);
                        this.showSelectAll_GOOGLE(this.filteredVendorList_google().length > 0);
                    }
                }

            }, this);
            this.iabSelected.subscribe(function (val) {
                this.showingFilter(false);
                document.getElementById("googleVendorList").style.display = this.iabSelected() ? "none" : "block";
                document.getElementById("vendorList").style.display = this.iabSelected() ? "block" : "none";
                document.getElementById("allGoogle").style.display = this.iabSelected() ? "none" : "block";
                document.getElementById("allIAB").style.display = this.iabSelected() ? "block" : "none";


                if (this.showClearButton() == true) {
                    this.showSelectAll_IAB(false);
                    this.showSelectAll_GOOGLE(false);
                } else {
                    this.showSelectAll_IAB(this.filteredVendorList().length > 0);
                    this.showSelectAll_GOOGLE(this.filteredVendorList_google().length > 0);
                }

            }, this);


            // button taps
            self.goBack = function () {

                const queryString = window.location.search;
                const urlParams = new URLSearchParams(queryString);
                const from = urlParams.get('from');

                if (from == null) {
                    Unity.call("HTTPS://OTSDK/vendorList|close");
                } else {
                    Unity.call("HTTPS://OTSDK/vendorList|back|" + from);
                }
            }
            self.clear = function () {

                this.showClearButton(false);

                var arrayLength = this.vendors().length;
                for (let i = 0; i < arrayLength; i++) {
                    var vendorListItem = this.vendors()[i];
                    vendorListItem.didMatchSearch(true)
                }

                this.searchValue("");

                this.showSelectAll_IAB(this.filteredVendorList().length > 0);
                this.showSelectAll_GOOGLE(this.filteredVendorList_google().length > 0);
            }
            self.goBackToList = function () {
                document.getElementById("VendorListPageFragment").className = "GoRightList";
                document.getElementById("VendorDetailPageFragment").className = "GoRightDetail";
                return true;
            }

            self.onScopeChange = function (item) {
                this.iabSelected(document.getElementById("iab").checked);
                this.vendors.valueHasMutated();
                return true;
            }
            self.vendorOnSwitch = function (item) {
                Unity.call("HTTPS://OTSDK/vendorlist|updateConsentValueForVendor|" + item.id + "|" + item.vendorConsentToggleIsOn().toString());
                return true;
            }

            self.googleVendorOnSwitch = function (item) {
                Unity.call("HTTPS://OTSDK/vendorlist|updateConsentValueForGoogleVendor|" + item.id + "|" + item.vendorConsentToggleIsOn().toString());
                return true;
            }
            self.vendorOnClick = function (item) {

                // ////////////////////////////////////////////////
                // if the filter is on,
                // then dismiss the filter and ignore the tap
                if (viewModel.showingFilter() == true) { return true; }

                // ////////////////////////////////////////////////
                //  prepare the vendor detail page
                //  then navigate to that page

                viewModel.SelectedVendorID(item.id);

                var arrayLength = viewModel.vendors().length;
                for (let i = 0; i < arrayLength; i++) {
                    var vendorListItem = viewModel.vendors()[i];
                    vendorListItem.isSelected(false);
                }

                item.isSelected(true);

                // item.shouldShowLegitimateInterestToggleForVendor = true;

                var startDate = new Date();
                var endDate = new Date();
                var cookieMaxAgeSeconds = item.cookieMaxAgeSeconds;

                endDate.setSeconds(endDate.getSeconds() + cookieMaxAgeSeconds);

                var startYear = startDate.getFullYear();
                var february = (startYear % 4 === 0 && startYear % 100 !== 0) || startYear % 400 === 0 ? 29 : 28;
                var daysInMonth = [31, february, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

                var yearDiff = endDate.getFullYear() - startYear;
                var monthDiff = endDate.getMonth() - startDate.getMonth();
                if (monthDiff < 0) {
                    yearDiff--;
                    monthDiff += 12;
                }
                var dayDiff = endDate.getDate() - startDate.getDate();
                if (dayDiff < 0) {
                    if (monthDiff > 0) {
                        monthDiff--;
                    } else {
                        yearDiff--;
                        monthDiff = 11;
                    }
                    dayDiff += daysInMonth[startDate.getMonth()];
                }


                if (yearDiff > 0) {
                    monthDiff += (yearDiff * 12);
                    yearDiff = 0;
                }

                item.lifespan = "";

                if (monthDiff > 0) {
                    item.lifespan += monthDiff;
                    if (monthDiff == 1) {
                        item.lifespan += " " + viewModel.data.vendorListLifespanMonth;
                    } else {
                        item.lifespan += " " + viewModel.data.vendorListLifespanMonths;
                    }
                }

                if (dayDiff > 0) {

                    if (item.lifespan.length > 0) {
                        item.lifespan += " ";
                    }

                    item.lifespan += dayDiff;
                    if (dayDiff == 1) {
                        item.lifespan += " " + viewModel.data.vendorListLifespanDay;
                    } else {
                        item.lifespan += " " + viewModel.data.vendorListLifespanDays;
                    }
                }

                if ((monthDiff + dayDiff) < 1) {
                    var answer = 24.0 / cookieMaxAgeSeconds;
                    answer = Math.round((answer + Number.EPSILON) * 100) / 100;
                    item.lifespan += answer + " " + viewModel.data.vendorListLifespanDays;
                }


                viewModel.consentPurposes.removeAll();;
                for (const jsonDataKey in item.purposes) {
                    const itemKey = item.purposes[jsonDataKey].toString();
                    const itemValue = viewModel.data.vendorListPurposes[itemKey];
                    viewModel.consentPurposes.push(itemValue);
                }

                viewModel.specialPurposes.removeAll();
                for (const jsonDataKey in item.specialPurposes) {
                    const itemKey = item.specialPurposes[jsonDataKey];
                    const itemValue = viewModel.data.vendorListSpecialPurposes[itemKey];
                    viewModel.specialPurposes.push(itemValue);
                }

                viewModel.consentFeatures.removeAll();
                for (const jsonDataKey in item.features) {
                    const itemKey = item.features[jsonDataKey];
                    const itemValue = viewModel.data.vendorListFeatures[itemKey];
                    viewModel.consentFeatures.push(itemValue);
                }

                viewModel.specialFeatures.removeAll();
                for (const jsonDataKey in item.specialFeatures) {
                    const itemKey = item.specialFeatures[jsonDataKey];
                    const itemValue = viewModel.data.vendorListSpecialFeatures[itemKey];
                    viewModel.specialFeatures.push(itemValue);
                }


                document.getElementById("VendorListPageFragment").className = "GoLeftList";
                document.getElementById("VendorDetailPageFragment").className = "GoLeftDetail";

                // window.location = "vendor-details.html?vendorID=" + item.id;

                return true;
            }
            self.filterOnClick = function (item) {
                this.showingFilter(!this.showingFilter());
                return true;
            }
            self.filterCancelOnClick = function (item) {
                this.showingFilter(false);
                try {
                    var arrayLength = this.FilterGroupNames().length;
                    for (let i = 0; i < arrayLength; i++) {
                        var filterItem = this.FilterGroupNames()[i];
                        var shouldSelect = this.orginalSelectedFilters.includes(filterItem.GroupNameMobile);
                        filterItem.isSelected(shouldSelect);
                    }
                } catch (err) {
                    document.getElementById("errorMsg").innerHTML = err.message;
                }

                return true;
            }

            self.allSwitchOnChange = function () {

                var newValue = !this.isAllSelected();
                var strVendors = "";

                var arrayLength = this.filteredVendorList().length;
                for (let i = 0; i < arrayLength; i++) {
                    var vendorListItem = this.filteredVendorList()[i];
                    if (vendorListItem.shouldShowConsentToggleForVendor == true && vendorListItem.isGoogleVendor == false) {
                        vendorListItem.vendorConsentToggleIsOn(newValue);
                        strVendors += strVendors.length > 0 ? "," : "";
                        strVendors += vendorListItem.id;
                    }
                }

                Unity.call("HTTPS://OTSDK/vendorlist|updateConsentValueForVendors|" + newValue.toString() + "|" + strVendors);

                return true;
            }
            self.allSwitchGoogleOnChange = function () {

                var newValue = !this.isAllSelected_google();
                var strVendors = "";

                var arrayLength = this.filteredVendorList_google().length;
                for (let i = 0; i < arrayLength; i++) {
                    var vendorListItem = this.filteredVendorList_google()[i];
                    if (vendorListItem.shouldShowConsentToggleForVendor == true && vendorListItem.isGoogleVendor == true) {
                        vendorListItem.vendorConsentToggleIsOn(newValue);
                        strVendors += strVendors.length > 0 ? "," : "";
                        strVendors += vendorListItem.id;
                    }
                }

                Unity.call("HTTPS://OTSDK/vendorlist|updateconsentvalueforgooglevendors|" + newValue.toString() + "|" + strVendors);

                return true;
            }

            // live search //
            this.delayedValue = ko.pureComputed(this.searchValue).extend({ rateLimit: { method: "notifyWhenChangesStop", timeout: 400 } });
            this.delayedValue.subscribe(function (val) {
                const filter = val.toUpperCase();
                this.showClearButton(filter.length > 0);
                var arrayLength = this.vendors().length;
                for (let i = 0; i < arrayLength; i++) {
                    var vendorListItem = this.vendors()[i];
                    if (filter.length == 0 || vendorListItem.searchName.includes(filter)) {
                        vendorListItem.didMatchSearch(true)
                    } else {
                        vendorListItem.didMatchSearch(false)
                    }
                }

            }, this);

            // detail page commands
            self.policyLinkOnClick = function (item) {
                window.location = item.policyUrl;
                return true;
            }

            self.onCheck = function (item) {
                var vendorID = item.id;
                var uiControlState = item.vendorConsentToggleIsOn().toString();
                Unity.call("HTTPS://OTSDK/vendordetails|updateconsentvalueforvendor|" + vendorID + "|" + uiControlState);
                return true;
            }

            self.onCheckLI = function (item) {
                var vendorID = item.id;
                var uiControlState = item.vendorLegitimateInterestToggleIsOn().toString();
                Unity.call("HTTPS://OTSDK/vendordetails|updateconsentvalueforvendorlegitimateinterest|" + vendorID + "|" + uiControlState);
                return true;
            }

        }

        // custom aria labels
        this.policyLinkAriaLabel = this.data.vendorListPolicyLinkText + ", " + this.data.pcPrivacyLinkActionAriaLabel;


        function reflectUnsavedChanges(data) {

            try {


                for (const vendorID in data) {
                    var vendorItem = data[vendorID];
                    var consent = vendorItem["consent"];
                    var li = vendorItem["li"];

                    if (consent != null) {
                        var arrayLength = viewModel.vendors().length;
                        for (let i = 0; i < arrayLength; i++) {
                            var vendorListItem = viewModel.vendors()[i];
                            if (vendorListItem.id == vendorID && vendorListItem.isGoogleVendor == false) {
                                var isOn = consent.toString() == "true";
                                document.getElementById('toggle_' + vendorID).checked = isOn;
                                vendorListItem.vendorConsentToggleIsOn(isOn);

                                isOn = li.toString() == "true";
                                vendorListItem.vendorLegitimateInterestToggleIsOn(isOn);

                                break;
                            }
                        }
                    }
                }

                viewModel.vendors.valueHasMutated();
                document.getElementById('allowAllSwitch').checked = viewModel.isAllSelected();

            } catch (err) {
                document.getElementById("errorMsg").innerHTML = err.message;

            }
        }



        function reflectUnsavedChangesGoogle(data) {

            try {

                for (const vendorID in data) {
                    var vendorItem = data[vendorID];
                    var consent = vendorItem["consent"];

                    if (consent != null) {
                        var arrayLength = viewModel.vendors().length;
                        for (let i = 0; i < arrayLength; i++) {
                            var vendorListItem = viewModel.vendors()[i];
                            if (vendorListItem.id == vendorID && vendorListItem.isGoogleVendor == true) {
                                var isOn = consent.toString() == "true";
                                document.getElementById('toggle_v' + vendorID).checked = isOn;
                                vendorListItem.vendorConsentToggleIsOn(isOn);
                                break;
                            }
                        }
                    }
                }

                viewModel.vendors.valueHasMutated();
                document.getElementById('allowAllGoogleSwitch').checked = viewModel.isAllSelected_google();


            } catch (err) {
                document.getElementById("errorMsg").innerHTML = err.message;

            }
        }

        function bannerColorsChanged(data) { }
        function pcColorsChanged(data) { }
        function vendorColorsChanged(data) { }
        function sdkListConsentsChanged(data) { }

    </script>

</head>

<body onload="onLoad()" data-bind="style:{'background-color':data.vendorListBackgroundColorCalculated}">

    <div id="spinner" class="lds-spinner">
        <div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>
    </div>

    <div id="errorMsg"></div>

    <div id="VendorListPageFragment" style="display:none">

        <div class="wrapper">

            <!--Header / Search-->
            <div class="header">

                <!--top nav bar -->
                <div class="topNarBar" data-bind="visible:data.showNavBar">

                    <div class="pageTitle" data-bind="html: data.vendorListPageHeaderTitle, style:{color:data.listItemTitleTextColorCalculated}"></div>
                    <div role="button" class="chevron-back-vl" data-bind="click:goBack, visible:data.showBackButton, style:{color:data.listItemTitleTextColorCalculated}, attr:{'aria-label': data.pCenterBackText}" tabindex="0"></div>

                    <!--filter icon-->
                    <div id="noFilter" class="search-filter-icon" data-bind="click:filterOnClick, visible:iabSelected, attr:{'aria-label': data.pcVendorListFilterUnselectedAriaLabel}" tabindex="3">
                        <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 700"><path d="m285.25 294.21v166.91c0 6.0547 3.1484 11.691 8.2969 14.875 2.8008 1.75 5.9844 2.625 9.2031 2.625 2.6602 0 5.3555-0.62891 7.8398-1.8555l94.465-47.25c5.9141-2.9766 9.6602-9.0312 9.6602-15.645v-119.66l153.44-184.14c4.375-5.2148 5.2852-12.496 2.4141-18.621-2.9062-6.1602-9.0664-10.078-15.855-10.078h-409.46c-6.7891 0-12.949 3.9219-15.855 10.078-2.8711 6.1602-1.9258 13.406 2.4492 18.656zm232.12-177.84-133.56 160.3c-2.6289 3.1484-4.0625 7.1055-4.0625 11.199v115.18l-59.465 29.75v-144.93c0-4.0938-1.4336-8.0508-4.0586-11.199l-133.56-160.3z"></path></svg>
                    </div>

                    <div id="filterApplied" class="search-filter-icon" data-bind="click:filterOnClick, visible:iabSelected, attr:{'aria-label': data.pcVendorListFilterSelectedAriaLabel}" tabindex="3">
                        <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 934 934"><path d="M 380.33,392.28 L 380.33,614.83 C 380.33,622.9 384.53,630.41 391.4,634.66 395.13,636.99 399.38,638.16 403.67,638.16 407.21,638.16 410.81,637.32 414.12,635.69 L 540.07,572.69 C 547.96,568.72 552.95,560.64 552.95,551.83 L 552.95,392.28 757.54,146.76 C 763.37,139.81 764.59,130.1 760.76,121.93 756.88,113.72 748.67,108.49 739.62,108.49 L 193.67,108.49 C 184.62,108.49 176.41,113.72 172.53,121.93 168.7,130.14 169.96,139.81 175.8,146.81 L 380.33,392.28 Z M 509,539 L 427.04,577.07 509,539 Z M 509,539"></path></svg>
                    </div>
                </div>

                <!--search container -->
                <div class="searchContainer">

                    <!--search icon-->
                    <span class="search-icon">
                        <svg focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
                    </span>

                    <!--search input box-->
                    <input role="search" class="search-vlist" type="text" data-bind="attr: {placeholder: data.pCenterVendorListSearch}, textInput:searchValue, hasFocus: searchHasFocus, style:{'background-color':data.vendorListSearchBackgroundColorCalculated, color:data.vendorListSearchBarTextColorCalculated}" id="vendor-list-search">

                    <!--clear button-->
                    <img role="button" class="clear-icon-vlist" data-bind="visible:showClearButton, click:clear" src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDUxLjk3NiA1MS45NzYiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUxLjk3NiA1MS45NzY7IiB4bWw6c3BhY2U9InByZXNlcnZlIiB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4Ij4KPGc+Cgk8cGF0aCBkPSJNNDQuMzczLDcuNjAzYy0xMC4xMzctMTAuMTM3LTI2LjYzMi0xMC4xMzgtMzYuNzcsMGMtMTAuMTM4LDEwLjEzOC0xMC4xMzcsMjYuNjMyLDAsMzYuNzdzMjYuNjMyLDEwLjEzOCwzNi43NywwICAgQzU0LjUxLDM0LjIzNSw1NC41MSwxNy43NCw0NC4zNzMsNy42MDN6IE0zNi4yNDEsMzYuMjQxYy0wLjc4MSwwLjc4MS0yLjA0NywwLjc4MS0yLjgyOCwwbC03LjQyNS03LjQyNWwtNy43NzgsNy43NzggICBjLTAuNzgxLDAuNzgxLTIuMDQ3LDAuNzgxLTIuODI4LDBjLTAuNzgxLTAuNzgxLTAuNzgxLTIuMDQ3LDAtMi44MjhsNy43NzgtNy43NzhsLTcuNDI1LTcuNDI1Yy0wLjc4MS0wLjc4MS0wLjc4MS0yLjA0OCwwLTIuODI4ICAgYzAuNzgxLTAuNzgxLDIuMDQ3LTAuNzgxLDIuODI4LDBsNy40MjUsNy40MjVsNy4wNzEtNy4wNzFjMC43ODEtMC43ODEsMi4wNDctMC43ODEsMi44MjgsMGMwLjc4MSwwLjc4MSwwLjc4MSwyLjA0NywwLDIuODI4ICAgbC03LjA3MSw3LjA3MWw3LjQyNSw3LjQyNUMzNy4wMjIsMzQuMTk0LDM3LjAyMiwzNS40NiwzNi4yNDEsMzYuMjQxeiIgZmlsbD0iIzAwMDAwMCIvPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=" />
                </div>

                <!--search scope bar -->
                <div class="search-scope" data-bind="visible:googleVendorsCount() > 0">
                    <div class="vendor-types">
                        <input type="radio" name="vendor-type" id="google" data-bind="checked: iabSelected == false, click:onScopeChange" />
                        <label for="google">Google</label>

                        <input type="radio" name="vendor-type" id="iab" data-bind="checked: iabSelected == true, click:onScopeChange" />
                        <label for="iab">IAB</label>
                    </div>
                </div>


                <!--allow all consent toggle-->
                <div id="allIAB" style="padding-left:12px">
                    <table class="vListTable" style="border-color: transparent; " data-bind="visible:showSelectAll_IAB">
                        <tbody>
                            <tr style="border-color: transparent; ">

                                <td class="vListTable-nameCol" style="border-color: transparent;">
                                    <label style="font-weight:bold" data-bind="text:data.vendorListAllowAllConsentText, style:{color:data.listItemTitleTextColorCalculated}">$ALLOW ALL CONSENT</label>
                                </td>

                                <td class="vListTable-switchCol" style="text-align: right; border-color: transparent;">
                                    <div>
                                        <label class="switch">
                                            <input id="allowAllSwitch" type="checkbox" data-bind="checked:isAllSelected, click:allSwitchOnChange">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>
                                </td>

                                <td class="vListTable-chevronCol" style="text-align: right; width: 10px; border-color: transparent;">
                                    <label class="chevron-right" style="color:transparent" />
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>

                <!--allow all consent toggle for Google Vendors-->
                <div id="allGoogle" style="padding-left:12px">
                    <table class="vListTable" style="border-color: transparent; " data-bind="visible:showSelectAll_GOOGLE">
                        <tbody>
                            <tr style="border-color: transparent; ">

                                <td class="vListTable-nameCol" style="border-color: transparent;">
                                    <label style="font-weight:bold" data-bind="text:data.vendorListAllowAllConsentText, style:{color:data.listItemTitleTextColorCalculated}">$ALLOW ALL CONSENT</label>
                                </td>

                                <td class="vListTable-switchCol" style="text-align: right; border-color: transparent;">
                                    <div>
                                        <label class="switch">
                                            <input id="allowAllGoogleSwitch" type="checkbox" data-bind="checked:isAllSelected_google, click:allSwitchGoogleOnChange">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>
                                </td>

                                <td class="vListTable-chevronCol" style="text-align: right; width: 10px; border-color: transparent;">
                                    <label class="chevron-right" style="color:transparent" />
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>


            </div>


            <!--Content / Tables-->
            <div class="content" style="flex:auto; overflow:auto; padding-left:12px;">
                <!--vendor List-->
                <div id="vendorList">
                    <table class="vListTable">

                        <tbody data-bind="foreach: filteredVendorList">
                            <tr>

                                <td class="vListTable-nameCol">
                                    <div data-bind="html: name, click:vendorOnClick, style:{color:$parent.data.listItemTitleTextColorCalculated, fontSize:$parent.data.listItemTitleFontSize}"></div>
                                </td>

                                <td class="vListTable-switchCol">
                                    <div data-bind="visible:shouldShowConsentToggleForVendor">
                                        <label class="switch">
                                            <input type="checkbox" data-bind="checked: vendorConsentToggleIsOn, click:vendorOnSwitch, attr: { id: 'toggle_' + id }">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>
                                </td>

                                <td class="vListTable-chevronCol">
                                    <div class="chevron-right" data-bind="click:vendorOnClick, style:{color:$parent.data.listItemTitleTextColorCalculated}" />
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>

                <!--google vendor List-->
                <div id="googleVendorList">
                    <table class="vListTable">
                        <tbody data-bind="foreach: filteredVendorList_google">
                            <tr>

                                <td class="vListTable-nameCol">
                                    <div data-bind="html: name, style:{color:$parent.data.listItemTitleTextColorCalculated}"></div>
                                </td>

                                <td class="vListTable-switchCol">
                                    <div data-bind="visible:shouldShowConsentToggleForVendor">
                                        <label class="switch">
                                            <input type="checkbox" data-bind="checked: vendorConsentToggleIsOn, click:googleVendorOnSwitch, attr: { id: 'toggle_v' + id }">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>
                                </td>

                                <td class="vListTable-chevronCol">
                                    <div class="chevron-right" style="color:transparent" />
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>


            <!--Footer / Filter-->
            <div id="footer" class="footer" data-bind="visible:showingFilter, style:{'background-color':data.vendorListBackgroundColorCalculated}" style="padding-right: 5px; padding-left: 5px; padding-bottom: 20px;">


                <!--cancel Button Show As TEXT-->
                <div tabindex="0" style="margin-left: 5px; margin-top: 10px; font-weight: bold" data-bind="hasFocus: showingFilter, click:filterCancelOnClick, text:data.cancelFiltersText, style:{color:data.listItemTitleTextColorCalculated, fontSize:data.listTitleFontSize}">$Close Filter Dialig</div>
                <hr />


                <!--list of filter options-->
                <div style="max-height:200px; overflow-y:scroll">

                    <table class="vListTable" style="border-color: transparent;">

                        <tbody data-bind="foreach: FilterGroupNames">
                            <tr style="border-color: transparent; ">

                                <!--filter name-->
                                <td style="border-color: transparent;">
                                    <label data-bind="text: GroupNameMobile, style:{color:$parent.data.listItemTitleTextColorCalculated, fontSize:$parent.data.listTitleFontSize}">$GroupNameMobile</label>
                                </td>

                                <!--filter switch-->
                                <td class="vListTable-switchCol" style="text-align: right; border-color: transparent;">
                                    <div>
                                        <label class="switch">
                                            <input type="checkbox" data-bind="checked: isSelected">
                                            <span class="slider round"></span>
                                        </label>
                                    </div>
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>


                <!--Apply Filter button-->
                <input type='button' class="cmdButton" style="margin-top:1em; margin-bottom:1em;" data-bind="click:filterOnClick, attr:{value:data.applyFiltersText}, style:{color:data.savePreferencesButtonTextColorCalculated, backgroundColor:data.savePreferencesButtonColorCalculated, 'border-radius':data.savePreferencesButtonBorderRadius, fontSize:data.savePreferencesButtonFontSize}" />



            </div>

        </div>

    </div>

    <div id="VendorDetailPageFragment">

        <div>

            <div class="wrapper">

                <div class="header">
                    <div class="topNarBar" data-bind="visible:data.showNavBar">
                        <div class="chevron-back" data-bind="click:goBackToList, style:{color:data.listItemTitleTextColorCalculated}"></div>
                    </div>
                    <div id="errorMsg2"></div>
                </div>



                <div class="content" style="padding-left:10px; padding-right:10px;">

                    <div data-bind="foreach: selectedVendors">

                        <!--vendor name-->
                        <div style="margin-bottom:0.5em; font-weight:bold;" data-bind="html:name, style:{color:$parent.data.listItemTitleTextColorCalculated, fontSize:$parent.data.vendorNameTitleFontSize}">$vendor name</div>

                        <!--Privacy Link-->
                        <div data-bind="visible:$parent.data.vendorListPolicyLinkShow, click:policyLinkOnClick, html:$parent.data.vendorListCookiePolicyText, style:{color:$parent.data.vendorListPolicyLinkTextColorCalculated, fontSize:$parent.data.vendorListPolicyLinkFontSize, 'text-align':$parent.data.vendorListPolicyLinkTextAlign}, attr:{'aria-label':policyLinkAriaLabel}" style="text-decoration: underline; margin-bottom: 0.5em;">$policyLinkText</div>


                        <!--toggle for consent  -->
                        <div data-bind="visible:shouldShowConsentToggleForVendor" style="display: flex; margin-top:15px;">

                            <!--Consent label-->
                            <div style="flex:auto;">
                                <span data-bind="html:$parent.data.vendorListConsentText, style:{color:$parent.data.descriptionTextColorCalculated, fontSize:$parent.data.listItemTitleFontSize}">$Consent</span>
                            </div>

                            <!--consent toggle-->
                            <div style="text-align: right;display:flex;align-items:center;">
                                <label class="switch">
                                    <input id="consentToggle" type="checkbox" data-bind="checked: vendorConsentToggleIsOn, click:onCheck">
                                    <span class="slider round"></span>
                                </label>
                            </div>

                        </div>


                        <!--toggle for Legitmate Interest -->
                        <div data-bind="visible:shouldShowLegitimateInterestToggleForVendor" style="display: flex; margin-top: 10px;">

                            <!--LI label-->
                            <div style="flex:auto;">
                                <span data-bind="html:$parent.data.vendorListLegitInterestText, style:{color:$parent.data.descriptionTextColorCalculated, fontSize:$parent.data.listItemTitleFontSize}">$Legitimate Interest</span>
                            </div>

                            <!--LI toggle-->
                            <div style="text-align: right;display:flex;align-items:center;">
                                <label class="switch">
                                    <input type="checkbox" data-bind="checked:vendorLegitimateInterestToggleIsOn, click:onCheckLI">
                                    <span class="slider round"></span>
                                </label>
                            </div>

                        </div>


                        <!--cookie life span-->
                        <div style="display: flex; margin-top: 15px; margin-bottom:1em;">

                            <!-- label-->
                            <div style="flex:auto;">
                                <span style="font-weight:bold" data-bind="html:$parent.data.vendorListLifespanText, style:{color:$parent.data.descriptionTextColorCalculated, fontSize:$parent.data.listItemTitleFontSize}">$Lifespan text</span>
                            </div>

                            <!-- calculated value-->
                            <div data-bind="html:lifespan, style:{color:$parent.data.descriptionTextColorCalculated, fontSize:$parent.data.listItemTitleFontSize}" style="text-align: right;display:flex;align-items:center; margin-right:0.5em;">
                                $lifespan
                            </div>

                        </div>



                        <!--description-->
                        <div data-bind="html:$parent.data.vendorListNonCookieUsageText, style:{color:$parent.data.descriptionTextColorCalculated, fontSize:$parent.data.listItemTitleFontSize}">$vendorListNonCookieUsageText</div>
                        <br>


                    </div>


                    <!--consent purposes-->
                    <div data-bind="visible:(consentPurposes().length > 0)">
                        <strong data-bind="html:data.vendorListConsentPurposesText, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">$Constent Purposes</strong>
                        <ul style="margin-left:-10px; margin-top:0;" data-bind="foreach: consentPurposes, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">
                            <li data-bind="html:name">$name</li>
                        </ul>
                    </div>


                    <!--special purposes-->
                    <div data-bind="visible:specialPurposes().length > 0">
                        <strong data-bind="html:data.vendorListSpecialPurposesText, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">$Special Purposes</strong>
                        <ul style="margin-left:-10px; margin-top:0;" data-bind="foreach: specialPurposes, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">
                            <li data-bind="html:name">$name</li>
                        </ul>
                    </div>



                    <!--features-->
                    <div data-bind="visible:consentFeatures().length > 0">
                        <strong data-bind="html:data.vendorListFeaturesText, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">$Features</strong>
                        <ul style="margin-left:-10px; margin-top:0;" data-bind="foreach: consentFeatures, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">
                            <li data-bind="html:name">$name</li>
                        </ul>
                    </div>


                    <!--special features-->
                    <div data-bind="visible:specialFeatures().length > 0">
                        <strong data-bind="html:data.vendorListSpecialFeaturesText, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">$Special Features</strong>
                        <ul style="margin-left:-10px; margin-top:0;" data-bind="foreach: specialFeatures, style:{color:data.descriptionTextColorCalculated, fontSize:data.listItemTitleFontSize}">
                            <li data-bind="html:name">$name</li>
                        </ul>

                    </div>
                    <br />


                </div>


                <div class="footer"> </div>


            </div>
        </div>
    </div>


</body>

</html>
